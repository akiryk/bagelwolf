---
import { ViewTransitions } from 'astro:transitions';
import SEO from '../components/SEO.astro';
import '../styles/global.css';

interface Props {
  title?: string;
  description?: string;
  image?: string;
  type?: 'website' | 'article';
  noindex?: boolean;
}

const {
  title = 'Bagelwolf Bakery',
  description = 'Handrolled sourdough bagels and artisan breads baked fresh in Durango, Colorado. Made with a homemade starter, traditional techniques, and 24-hour cold fermentation.',
  image,
  type,
  noindex,
} = Astro.props;
const currentPath = Astro.url.pathname;

const navLinks = [
  { href: '/bagels', label: 'BAGELS' },
  { href: '/bread', label: 'BREADS' },
  { href: '/about', label: 'ABOUT' },
];

function isActive(href: string): boolean {
  if (href === '/') {
    return currentPath === '/';
  }
  return currentPath.startsWith(href);
}
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <SEO title={title} description={description} image={image} type={type} noindex={noindex} />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;700&family=Spectral:wght@200;300&display=swap"
      rel="stylesheet"
    />
    <ViewTransitions />
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0ZT1PZ1PR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-0ZT1PZ1PR7');
    </script>
    <!-- Microsoft Clarity -->
    <script>
      (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window,document,"clarity","script","ujyyq6cqdg");
    </script>
    <!-- MailerLite Universal -->
    <script>
      (function (w, d, e, u, f, l, n) {
        ((w[f] =
          w[f] ||
          function () {
            (w[f].q = w[f].q || []).push(arguments);
          }),
          (l = d.createElement(e)),
          (l.async = 1),
          (l.src = u),
          (n = d.getElementsByTagName(e)[0]),
          n.parentNode.insertBefore(l, n));
      })(
        window,
        document,
        'script',
        'https://assets.mailerlite.com/js/universal.js',
        'ml'
      );
      ml('account', '1976134');
    </script>
    <!-- End MailerLite Universal -->
  </head>
  <body class="min-h-screen flex flex-col bg-white text-stone-800 font-sans">
    <header class="bg-white">
      <!-- Centered Logo -->
      <div class="text-center mb-6">
        <a href="/" class="inline-block">
          <img
            src="/images/bagel-wolf-logo.png"
            alt="BagelWolf - A wolf sitting on a stool holding a bagel"
            class="w-[400px] max-w-full mx-auto mt-4"
          />
        </a>
        <p class="font-serif text-stone-500 text-lg tracking-wide">
          Handrolled Sourdough Bagels & Artisanal Breads
        </p>
      </div>

      <!-- Navigation Bar -->
      <nav class="border-t border-b border-stone-200">
        <div
          class="max-w-[1600px] mx-auto px-4 py-3 flex items-center justify-between"
        >
          <ul class="flex gap-6 md:gap-8">
            {
              navLinks.map((link) => (
                <li>
                  <a
                    href={link.href}
                    class:list={[
                      'text-sm tracking-wider transition-colors',
                      isActive(link.href)
                        ? 'font-bold text-stone-900'
                        : 'text-stone-600 hover:text-stone-900',
                    ]}
                    aria-current={isActive(link.href) ? 'page' : undefined}
                  >
                    {link.label}
                  </a>
                </li>
              ))
            }
          </ul>
          <a
            href="#"
            class="px-5 py-2 bg-brand text-white text-sm font-medium tracking-wider rounded hover:bg-brand-dark transition-colors focus:outline-none focus:ring-2 focus:ring-brand focus:ring-offset-2"
          >
            ORDER NOW
          </a>
          <!-- TODO: Replace # with actual ordering link -->
        </div>
      </nav>
    </header>

    <main id="main-content" class="flex-1">
      <slot />
    </main>

    <footer class="bg-stone-800 text-stone-200 py-12">
      <div class="max-w-5xl mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <!-- Brand & Location -->
          <div>
            <h2 class="font-serif text-xl text-white mb-2">BagelWolf</h2>
            <p class="text-stone-400">Durango, Colorado</p>
          </div>

          <!-- Contact -->
          <div>
            <h2 class="font-serif text-xl text-white mb-2">Contact</h2>
            <p class="text-stone-400">
              <a
                href="mailto:hello@bagelwolf.com"
                class="hover:text-white transition-colors"
              >
                hello@bagelwolf.com
              </a>
            </p>
            <p class="text-stone-400 mt-1">
              <a
                href="https://instagram.com/bagelwolf"
                target="_blank"
                rel="noopener noreferrer"
                class="hover:text-white transition-colors"
              >
                @bagelwolf
              </a>
            </p>
          </div>

          <!-- Newsletter Signup -->
          <div class="ml-embedded" data-form="37scIv"></div>
        </div>

        <div
          class="mt-8 pt-8 border-t border-stone-700 text-center text-stone-500 text-sm"
        >
          &copy; {new Date().getFullYear()} BagelWolf. All rights reserved.
        </div>
      </div>
    </footer>
  </body>
</html>
